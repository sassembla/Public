<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1265.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Kaku Gothic ProN'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'}
    span.s1 {font: 22.0px Helvetica}
    span.s2 {font: 12.0px Helvetica}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><span class="s1"><b>Unity</b></span><b>のコンパイル中か否かをメインスレッド外から見分ける方法</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>概要</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>そもMainThread外からそういうのを知る方法があるのか？</p>
<p class="p3"><span class="Apple-tab-span">	</span>という話をしていたら、</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>Unityがコンパイル時に作成、削除してるファイルの存在をけーご君から教えて貰った。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>内容</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>Unity Editorがコンパイル中にSublimeSocketAssetのコード補完走らせたりすると、</p>
<p class="p3"><span class="Apple-tab-span">	</span>SublimeSocketAssetが原因でUnity Editorが固まる、という感じだったので、</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>対処法としてコンパイル中だったら補完を走らせなくする、とかを考えようとしていたが、</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p3"><span class="Apple-tab-span">	</span>MainThread外からUnityがコンパイル中かどうかを知る術が無い。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>というわけで、下記の出番。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>Project/Library/ScriptAssemblies/CompilationCompleted.txt というファイルが、</p>
<p class="p3"><span class="Apple-tab-span">	</span>・コンパイル開始時に消される</p>
<p class="p3"><span class="Apple-tab-span">	</span>・コンパイル完了時に作成される</p>
<p class="p3"><span class="Apple-tab-span">	</span>という挙動をしてる。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>Win版も一緒っぽい。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>わかりやすいかどうかはアレだがgifで。</p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span></b><span class="s2"><img src="2014-06-30%2000_17_06.gif" alt="2014-06-30 00_17_06.gif"></span></p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>SublimeSocketAssetだと、ファイル保存のアクションからUnityのコンパイルを(Unityから開いたファイルで無くとも)</p>
<p class="p3"><span class="Apple-tab-span">	</span>実行されるので、</p>
<p class="p2"><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>保存(⌘+s) -&gt; コンパイル開始 -&gt; Finderから該当のファイルが消える -&gt; コンパイル終了と同時にファイルが現れる</b></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>というのが観測できた。</p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>コンパイル中にUnityEditor内でThread走らせると、変な死に方することが有るらしい。</p>
<p class="p3"><span class="Apple-tab-span">	</span>まあなーーー実行系がそれだしな。</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p3"><span class="Apple-tab-span">	</span>このへんでコンパイル中だったら、みたいな処理を作るかなあ。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
</body>
</html>
