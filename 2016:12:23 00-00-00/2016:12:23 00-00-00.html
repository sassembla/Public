<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1504.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Sans'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; color: #337ab7}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 17.0px 'Hiragino Sans'}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 17.0px 'Hiragino Sans'; min-height: 26.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 21.0px 'Hiragino Sans'}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; background-color: #ebebeb}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; background-color: #ebebeb; min-height: 18.0px}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; background-color: #ffffff}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; background-color: #ffffff; min-height: 18.0px}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 15.0px; font: 17.0px 'Hiragino Sans'; background-color: #ffffff}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 15.0px; font: 12.0px 'Hiragino Sans'; background-color: #ffffff}
    p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 15.0px; font: 12.0px 'Hiragino Sans'; background-color: #ffffff; min-height: 18.0px}
    p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Hiragino Sans'; background-color: #ebebeb}
    p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Hiragino Sans'; background-color: #ebebeb; min-height: 20.0px}
    p.p17 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 15.0px; font: 12.0px 'Hiragino Sans'; background-color: #ebebeb}
    p.p18 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 15.0px; font: 12.0px Helvetica; background-color: #ffffff}
    p.p19 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 15.0px; font: 12.0px Helvetica; background-color: #ffffff; min-height: 14.0px}
    p.p20 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; background-color: #ffffff}
    p.p21 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; background-color: #ffffff; min-height: 14.0px}
    span.s1 {color: #000000}
    span.s2 {font: 12.0px 'Helvetica Neue'; font-kerning: none}
    span.s3 {font-kerning: none}
    span.s4 {background-color: #ebebeb}
    span.s5 {color: #ff2600}
    span.s6 {color: #ff9300}
    span.s7 {color: #77bb41}
    span.s8 {color: #00c7fc}
    span.s9 {color: #0433ff}
    span.s10 {color: #942192}
    span.s11 {font: 12.0px 'Hiragino Sans'}
    span.s12 {font: 12.0px Helvetica}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><b>AssetBundleGraph作ってみた 気持ち全国から選りすぐりのサンプル集を大公開！</b></p>
<p class="p2"><br></p>
<p class="p3"><b>概要</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>本稿はUnity アドベントカレンダー (2) 12/23日の記事になる。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://qiita.com/advent-calendar/2016/unity2">http://qiita.com/advent-calendar/2016/unity2</a></p>
<p class="p2"><br></p>
<p class="p4"><span class="s1"><span class="Apple-tab-span">	</span>昨日は<a href="http://qiita.com/Ellise_MX">Ellise_MX</a>さんの[</span><span class="s2">Unity+FuelPHP+PhotonNetwork</span><span class="s3">でオンラインゲームの基礎作り</span><span class="s1">]でした。</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>明日は<a href="http://qiita.com/murapong">murapong</a>さんの、[Unity Cloud Buildのビルド結果をHipChatに通知するには]です。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>AssetBundleとかUnityのAssetの設定とかをとにかく力強く楽に扱えるツール「AssetBundleGraph(ABG)」の話をする。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>あと実は、このページはUnibook 総集編からも参照されている。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>今回のお題目</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>AssetBundleGraphの使用例などを公開できればとおもう。</p>
<p class="p3"><span class="Apple-tab-span">	</span>Unity 5.4.2で試している。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>AssetBundleGraph</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>いろいろあって、UnityのAssetBundle(ほか)をフロー形式で作り出すツール制作のお手伝いをしていた。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>これ。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>新しいアセットバンドルツールのプロトタイプ</b></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://blogs.unity3d.com/jp/2016/10/25/new-assetbundle-graph-tool-prototype/">https://blogs.unity3d.com/jp/2016/10/25/new-assetbundle-graph-tool-prototype/</a></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>で、かかわった動機とか経緯とかは過去の記事にあるので興味のある人はどうぞ。うかつに人にいちゃもんをつけに行くと色々なことが起こるのがよくわかった。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://sassembla.github.io/Public/2015:04:13%2019-06-37/2015:04:13%2019-06-37.html">http://sassembla.github.io/Public/2015:04:13%2019-06-37/2015:04:13%2019-06-37.html</a></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-&gt; 自作のAssetStoreにあるやつをプレゼンする -&gt; じゃあお前やれよ(丸みを帯びた表現) -&gt; ニュースリリースと。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>すでに自分の手は離れており、BitBucket上でゴリゴリと開発/改良/改善が進められている。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>で、今回はそんなAssetBundleGraphのサンプルを何パターンか作ってみよう、みたいな話。<span class="Apple-tab-span">	</span>だいじょうぶ、ファミ通でもなんでもない攻略本だよ。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p5"><b>！！注意！！</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>大事なことを言い忘れてた。</p>
<p class="p6"><br></p>
<p class="p5"><span class="Apple-tab-span">	</span>AssetBundleGraphは</p>
<p class="p5"><span class="Apple-tab-span">	</span>AssetBundleを作るためだけに使えるツールでは</p>
<p class="p7"><b><span class="Apple-tab-span">	</span>ない！！！</b></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>このツールは、いままで手でやっていたUnityのAsset一個ずつに対しての操作を、ルールベースでとにかく大雑把かつ人間より正確にサクッと実行する、というツールなのだ。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>iOS用に全ての画像の設定を変えたりとか、英語版だからこのグラフィック使おうねとか、これらのモデルの設定を全部ああしますとかそういうのを</p>
<p class="p5"><span class="Apple-tab-span">	</span>適当にまとめて実行できる</p>
<p class="p3"><span class="Apple-tab-span">	</span>のだ。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>複数のAssetから複雑なプレファブ作ったりするのも</p>
<p class="p5"><span class="Apple-tab-span">	</span>適当にまとめて実行できる</p>
<p class="p3"><span class="Apple-tab-span">	</span>のだ。プレファブまわりはさすがにちょっとコード要るんだけど。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>たまたまその動作の一つとして</p>
<p class="p3"><span class="Apple-tab-span">	</span>AssetBundleを作れる</p>
<p class="p3"><span class="Apple-tab-span">	</span>というのがあるだけなのだ。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>では例の紹介に行ってみよう。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p3"><b>AssetBundleGraph使用例6本ノック</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>取り上げさせてもらったネタはこちらのシートにあるやつのいくつか。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://docs.google.com/spreadsheets/d/1jHv8mFy2HhnnXCRr0tXHRLzt0ve4xGJebas8Q9R31Mo/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1jHv8mFy2HhnnXCRr0tXHRLzt0ve4xGJebas8Q9R31Mo/edit?usp=sharing</a></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>サンプルモリモリのリポジトリはこちら。</p>
<p class="p3"><span class="Apple-tab-span">	</span><b>Advent2016_AssetBundleGraph</b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph">https://github.com/sassembla/Advent2016_AssetBundleGraph</a></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>サンプルはそれぞれブランチに分かれている。</b></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>各内容の解説は下の方に書いて行く。長い。</p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>リポジトリにあるようなAsset生成が捗る環境を、手元に用意するには</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>readmeにも書くつもりだけれど、短いのでこちらにも書いておく</p>
<p class="p2"><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>1.適当なリソースの入ったプロジェクトを用意する</b></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>もちろん、「あっAssetBundleGraph使ってAssetをゴインゴインしよう」っていう対象のAssetがいっぱいあるリポジトリとかでいいと思う。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>もしくは、適当に空のプロジェクトを作って、適当に画像とかモデルとかをAssetsフォルダ以下に入れたものを用意するのでもいい。</p>
<p class="p2"><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>2.bitbucketのライブラリからAssetBundleGraphをDLする</b></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://bitbucket.org/Unity-Technologies/assetbundlegraphtool/downloads">https://bitbucket.org/Unity-Technologies/assetbundlegraphtool/downloads</a></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>3.ダウンロードしてきたAssets/AssetBundleGraph フォルダを、1で用意したプロジェクトのAssetsフォルダに放り込む</b></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>準備は以上！</p>
<p class="p2"><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>4.使う</b></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>メニュー &gt; Window &gt; AssetBundleGraph &gt; Open Graph Editor で、グラフのウィンドウが表示されるので、右クリックでノードを作ったりいろいろする。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>やりたいこと募集中(だった。)</b></p>
<p class="p8"><span class="Apple-tab-span">	</span>なにぶんグラフィカルになんとかするのに特化してるツールなんで、とっつきやすいが深堀りするとなるとまあ、</p>
<p class="p8"><span class="Apple-tab-span">	</span>本家のAssetBundle作りにならう感じで、まあ、例がない。</p>
<p class="p9"><br></p>
<p class="p8"><span class="Apple-tab-span">	</span><b>みなさんがやりたいことはたくさんあると思うんだけど、そのための例がない</b>、という状況はめっちゃ肌感的に共感できるつもり(傲慢</p>
<p class="p9"><br></p>
<p class="p8"><span class="Apple-tab-span">	</span>というか自分が「わからねえぞ、、なんだこれはどうやればいいんだ、、」って思ったことがあるのもあって、少しでも人の理解を手伝いたい。</p>
<p class="p8"><span class="Apple-tab-span">	</span>今回は最新版を使うのだけれど、自分が関わっていた時(だいたい今年の5月とか6月)より遥かにパワーアップしていた。恐ろしいツール。</p>
<p class="p9"><br></p>
<p class="p8"><span class="Apple-tab-span">	</span>なので、こう、</p>
<p class="p9"><br></p>
<p class="p8"><b><span class="Apple-tab-span">	</span>「こんなリソースをAssetbundleGraphで作るにはどうすればいいのか？」 </b>みたいなリクエストを募ろうと思う。</p>
<p class="p8"><span class="Apple-tab-span">	</span>まあ、気長に。</p>
<p class="p9"><br></p>
<p class="p8"><span class="Apple-tab-span">	</span>宛先はこちら。</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>AssetBundle(ほか)制作やっていき隊</b></p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://docs.google.com/spreadsheets/d/1jHv8mFy2HhnnXCRr0tXHRLzt0ve4xGJebas8Q9R31Mo/edit?usp=sharing">https://docs.google.com/spreadsheets/d/1jHv8mFy2HhnnXCRr0tXHRLzt0ve4xGJebas8Q9R31Mo/edit?usp=sharing</a></p>
<p class="p9"><br></p>
<p class="p9"><br></p>
<p class="p8"><span class="Apple-tab-span">	</span>ちなみに、</p>
<p class="p8"><span class="Apple-tab-span">	</span><b>ラジオのお葉書</b>みたいな感じで、稀に読み上げて参考にすることはあっても、絶対に応答があるわけではない。ごめん。</p>
<p class="p9"><br></p>
<p class="p9"><br></p>
<p class="p8"><span class="Apple-tab-span">	</span>べつにAssetBundleGraphを使って解決しないかもしれないけど、別の手段はありそうな感じで。</p>
<p class="p10"><span class="Apple-tab-span">	</span>みたいなことが書いてあったんですよ。アドベントカレンダー当日までは。</p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span>さてやっとここから、<b>公募で適当に集まった例を実際にAssetBundleGraphでなんとかしてみたもの</b>の説明になる。</p>
<p class="p10"><span class="Apple-tab-span">	</span>各お題は、同名のブランチがリポジトリ(<a href="https://github.com/sassembla/Advent2016_AssetBundleGraph">https://github.com/sassembla/Advent2016_AssetBundleGraph</a>)にあるので、それをDLしながら眺めてもらえるとわかりやすいと思う。</p>
<p class="p11"><br></p>
<p class="p11"><br></p>
<p class="p12"><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/tree/%23%E8%A4%87%E6%95%B0%E3%81%AE%E7%B4%A0%E6%9D%90%E3%81%AE%E3%82%BB%E3%83%83%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0%E3%82%92%E4%B8%80%E6%8B%AC%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B"><b>複数の素材のセッティングを一括変更する</b></a></p>
<p class="p13"><span class="Apple-tab-span">	</span>「この種類の画像はGUIに使うので、まるっと全部UI用の設定がしたい」、とかの要望があると思う。</p>
<p class="p13"><span class="Apple-tab-span">	</span>あるいはもっと複雑な、「TextureのタイプをAdvancedにして、wrapモードをこれに変えて、そんでループを、、」とかをいちいち全部手でやると発狂しかけると思う。</p>
<p class="p13"><span class="Apple-tab-span">	</span>そしてさらに、素材が入っているフォルダを分けたりするのが人情。一括での設定変換をこれでもかといわんばかりに難しくしてくれる。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>そんな時、いちいちGUIから設定を変えることなく、一括で大量のファイルの設定を変更できる機能のデモが、このブランチ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>まず、グラフを右クリックして、Loaderノードを置く。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="0.png" alt="0.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>クリックすると、Inspectorが開く。で、ここでは、Assets/Game/Images っていうフォルダにサンプルとしてユニティちゃんとかの画像が置いてあるので、</p>
<p class="p13"><span class="Apple-tab-span">	</span>その画像を読み込む(Loadする)ようにしてみる。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="1.png" alt="1.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>ちなみにAssets/Game/Imagesの中身はこんな感じ。画像いろいろ。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.02.36.png" alt="スクリーンショット 2016-12-22 2.02.36.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>次に、グラフを右クリックしてImportSettingsノードを追加。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%201.59.58.png" alt="スクリーンショット 2016-12-22 1.59.58.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>選択すると、Inspectorにこんな感じの見慣れないボタンが表示される。</p>
<p class="p13"><span class="Apple-tab-span">	</span>で、Configure Import Settings ボタンを押すと、</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%201.59.59.png" alt="スクリーンショット 2016-12-22 1.59.59.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>Loaderがロードしてきた画像のInspectorに切り替わる。</p>
<p class="p13"><span class="Apple-tab-span">	</span>さてとりあえず設定を弄ろう。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.00.12.png" alt="スクリーンショット 2016-12-22 2.00.12.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>Advancedに変えて、いろいろ変えて、、、</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.01.51.png" alt="スクリーンショット 2016-12-22 2.01.51.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>で、設定を適応させる。ここまでは通常通りのImportSettingsの手順。</p>
<p class="p10"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.02.01.png" alt="スクリーンショット 2016-12-22 2.02.01.png"></p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span>AssetBundleGraph実行！！(右のほうのBuildボタンを押す</p>
<p class="p10"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%203.23.40.png" alt="スクリーンショット 2016-12-23 3.23.40.png"></p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p10"><span class="Apple-tab-span">	</span>そして、先ほどの画像が置いてあるフォルダを覗いてみると、、</p>
<p class="p10"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.02.36.png" alt="スクリーンショット 2016-12-22 2.02.36.png"></p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p10"><span class="Apple-tab-span">	</span>すべての画像のセッティングが、先ほどセットした一枚の設定とクリソツになっている！</p>
<p class="p10"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.02.41.png" alt="スクリーンショット 2016-12-22 2.02.41.png"></p>
<p class="p11"><br></p>
<p class="p10"><b><span class="Apple-tab-span">	</span>やったぜ！</b></p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span>置いたノードは2つだけだが、</p>
<p class="p10"><span class="Apple-tab-span">	</span>・特定のフォルダにある画像全部に対して同じ設定を行う</p>
<p class="p10"><span class="Apple-tab-span">	</span>というのが瞬殺できた。</p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span>応用としては、</p>
<p class="p10"><span class="Apple-tab-span">	</span>複数のフォルダの画像を、複数のLoaderノードで読みこんで、一つのImportSettingsノードに流し込んで、全部一発で設定したり、</p>
<p class="p10"><span class="Apple-tab-span">	</span>このフォルダ以下の画像で名前にUI_って含んである画像は～ みたいな分岐も作り出せる。(Filterノードを使う</p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span>また、ImportSettingsノードは、画像だけでなくAudio、Modelに対しても対応しているので、それらにも同じようなことが実現できる。</p>
<p class="p10"><span class="Apple-tab-span">	</span>それ以外のAssetでは、Modifierノードを使うといい感じに編集できそう。</p>
<p class="p11"><br></p>
<p class="p11"><br></p>
<p class="p12"><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/tree/%23%E8%A4%87%E6%95%B0%E3%81%AE%E7%B4%A0%E6%9D%90%E3%81%8B%E3%82%89%E3%83%97%E3%83%AC%E3%83%95%E3%82%A1%E3%83%96%E3%82%92%E4%BD%9C%E3%82%8B"><b>複数の素材からプレファブを作る</b></a></p>
<p class="p13"><span class="Apple-tab-span">	</span>Prefab(プレファブ)を作成する、というのが、これが数がかさんでくると重労働だ。</p>
<p class="p13"><span class="Apple-tab-span">	</span>たとえばPrefabの構成に変更があった時とか、手でやってると正直しんどい。ミスも出る。</p>
<p class="p13"><span class="Apple-tab-span">	</span>じゃあスクリプトを書いて自動化する？　その自動化するコード毎回全部書くの？</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>という煽りに対して、AssetBundleGraphはわりといい感じの答えを用意してくれている。</p>
<p class="p13"><span class="Apple-tab-span">	</span>PrefabBuilderノードを使うのだ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>まず、ユニティちゃんsの画像が入ったフォルダを、下記のように「キャラごとに」用意する。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.11.30.png" alt="スクリーンショット 2016-12-22 2.11.30.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>各フォルダの中には、各キャラの立ち絵が6枚ずつ入っている。</p>
<p class="p13"><span class="Apple-tab-span">	</span>今回はこの各キャラ6枚の絵を、アニメーションとしてTexture2Dの配列に格納したPrefabを、各キャラごとに一つ作る、というのをやってみる。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>prefabの要件はこんな感じ。</p>
<p class="p13"><span class="Apple-tab-span">	</span>・prefabを3キャラ分、各キャラ一個作る</p>
<p class="p13"><span class="Apple-tab-span">	</span>・prefabの内容は、GameObjectに特定のScriptがセットされている &amp; ScriptのTexture2D[] texturesには各キャラのTextureが6枚ずつセットされている。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>さて、やっていこう。</p>
<p class="p13"><span class="Apple-tab-span">	</span>とりあえず素材を用意した段階で、フォルダ名に注目してほしい。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.11.30.png" alt="スクリーンショット 2016-12-22 2.11.30.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>フォルダ名は、chara_キャラ名 という感じで、ルールをもたせてある。</p>
<p class="p13"><span class="Apple-tab-span">	</span>このルールを利用して、prefabづくりを簡単にすることができる。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>そしてprefabになるGameObjectにセットするScriptだが、これは自分で用意する。</p>
<p class="p13"><span class="Apple-tab-span">	</span>サンプルでは Assets/MyCubeScript.cs というScriptを用意した。</p>
<p class="p14"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>MyCubeScript.cs</b></p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/blob/%23%E8%A4%87%E6%95%B0%E3%81%AE%E7%B4%A0%E6%9D%90%E3%81%8B%E3%82%89%E3%83%97%E3%83%AC%E3%83%95%E3%82%A1%E3%83%96%E3%82%92%E4%BD%9C%E3%82%8B/Assets/MyCubeScript.cs">https://github.com/sassembla/Advent2016_AssetBundleGraph/blob/%23複数の素材からプレファブを作る/Assets/MyCubeScript.cs</a></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>内容は至って簡単、Texture2D[] textures というパラメータを、lengthが６だと指定して初期化してあるだけ。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>では、これらを使ってprefabを作る工程に入ろう。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>まずはLoaderノードを置き、ロードする素材のパスをセットする。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.11.36.png" alt="スクリーンショット 2016-12-22 2.11.36.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>Assets/Game/Images フォルダ以下に上記の3キャラのフォルダが入っているので、指定。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.11.42.png" alt="スクリーンショット 2016-12-22 2.11.42.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>次に、Groupingノードを作成する。Loaderと適当につなごう。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.12.04.png" alt="スクリーンショット 2016-12-22 2.12.04.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>そしてGroupingノードを選択して、InspectorからGrouping Keywordを編集する。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.19.59.png" alt="スクリーンショット 2016-12-22 2.19.59.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>ここでは、&lt;chara_*/&gt; という文字列を入れている。<span class="Apple-tab-span">	</span></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>こう書くと、「chara_なにか/」というパターンで、</p>
<p class="p13"><span class="Apple-tab-span">	</span>Loaderから流れてきているAssetのパスをもとに、</p>
<p class="p13"><span class="Apple-tab-span">	</span>素材を複数のグループに分割することができる。<span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>ちょっと何いってるかわからないので、仮にBundleConfigノードを作って置いてつないでみよう。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.20.09.png" alt="スクリーンショット 2016-12-22 2.20.09.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>18:3 みたいな表記が、接続線の上に表示されたと思う。このボタンを押すと、接続線を流れるAssetsの内容が、Inspectorに表示される。</p>
<p class="p13"><span class="Apple-tab-span">	</span>お判りだろうか。18個のAssetsが、3つのグループに分割されているのが。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.20.10.png" alt="スクリーンショット 2016-12-22 2.20.10.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>お判りだろうか。Group Key: のところに、kohaku, misaki, yuko とかキャラ名が入っているのが。</p>
<p class="p13"><span class="Apple-tab-span">	</span>Groupingノードでは、あらかじめフォルダ名にルールをつけておくことで、それらをグループ名にしてAssetsをグループ化することができるのだ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>いや～これ思いついた時は俺すげーって思ったよ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>で、</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>やりたいことは「これらのグループ化されたAssetsからprefabを作る」ということなので、</p>
<p class="p13"><span class="Apple-tab-span">	</span>BundleConfigノードは一回消そう。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>PrefabBuilderノードを作成する。と、エラーが出る。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.20.54.png" alt="スクリーンショット 2016-12-22 2.20.54.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>なになに？ って選択してInspectorを見に行くと、</p>
<p class="p13"><span class="Apple-tab-span">	</span>「PrefabBuilderにはPrefabBuilder scriptが必要だよ」と出る。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.21.39.png" alt="スクリーンショット 2016-12-22 2.21.39.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>すいませんそうなんです。script要るんです。</p>
<p class="p13"><span class="Apple-tab-span">	</span>でもこれも作成できるんだよこのツール。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>ツールバー &gt; Window &gt;AssetBundleGraph &gt; Create Node Script &gt; PrefabBuilder Script を選択。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.22.21.png" alt="スクリーンショット 2016-12-22 2.22.21.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>選択すると、scriptが作成されて、コンパイルが走る。</p>
<p class="p13"><span class="Apple-tab-span">	</span>で、コンパイルが終わったら、PrefabBuilderを選択して、</p>
<p class="p13"><span class="Apple-tab-span">	</span>PrefabBuilderというパラメータのドロップダウンをクリックし、MyBuilderを選ぼう。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%203.54.49.png" alt="スクリーンショット 2016-12-23 3.54.49.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>すると、PrefabBuilderノードにMyBuilderというコードがセットされ、</p>
<p class="p13"><span class="Apple-tab-span">	</span>エラーが消える。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>以降、PrefabBuilderノードが実行されると、MyBuilderというコードが自動的に実行されるようになる。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%202.22.22.png" alt="スクリーンショット 2016-12-22 2.22.22.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>MyBuilderのコードは、作成直後は雛形のような感じになっている。</p>
<p class="p13"><span class="Apple-tab-span">	</span>コードは次のパスにある。</p>
<p class="p13"><span class="Apple-tab-span">	</span>Assets/AssetBundlerGraph/Generated/Editor/MyPrefabBuilder.cs</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>内容はこんな感じ。解説は日本語でお送りします</p>
<p class="p13"><span class="Apple-tab-span">	</span>MyPrefabBuilder.cs</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/blob/%23%E8%A4%87%E6%95%B0%E3%81%AE%E7%B4%A0%E6%9D%90%E3%81%8B%E3%82%89%E3%83%97%E3%83%AC%E3%83%95%E3%82%A1%E3%83%96%E3%82%92%E4%BD%9C%E3%82%8B/Assets/AssetBundleGraph/Generated/Editor/MyPrefabBuilder.cs">https://github.com/sassembla/Advent2016_AssetBundleGraph/blob/%23複数の素材からプレファブを作る/Assets/AssetBundleGraph/Generated/Editor/MyPrefabBuilder.cs</a></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>やっていることは、</p>
<p class="p13"><span class="Apple-tab-span">	</span>・CanCreatePrefab関数で、ABG実行前のRefresh時に実行される関数の結果として、入力されてくるデータのチェックや、チェックがOKだったらprefab名を返す処理を書く。このprefab名はABG実行時に使用される(その名前のprefabがダイレクトに作られる)。</p>
<p class="p13"><span class="Apple-tab-span">	</span>・CreatePrefab関数で、ABG実行時に実行されてほしい処理を書く。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>まずはCanCreatePrefab関数の内容を見る。</p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>/**</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * Test if prefab can be created with incoming assets.</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> * @result Name of prefab file if prefab can be created. null if not.</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> */</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>public string CanCreatePrefab (string groupKey, List&lt;UnityEngine.Object&gt; objects) {</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/*</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>この関数では、セッティングの途中で「どんなオブジェクトがAssetBundleGraphから流れてくるか」というのをチェックしたりすることができる。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>ここでは各グループで6つずつのTextureが来るはずなので、</span></p>
<p class="p16"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>6枚テクスチャがあったらPrefabができる という予定で値を返してみる。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>*/</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (objects.Count != 6) {</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 足りない！</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Debug.LogError("texture shortage. groupKey:" + groupKey);</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return null;</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>foreach (var obj in objects) {</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if (obj.GetType() != typeof(Texture2D)) {</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// テクスチャ2Dじゃない！！</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Debug.LogError("obj is not Texture2D. obj:" + obj + " in groupKey:" + groupKey);</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return null;</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 入力されてるアセット的にOKだったら、最終的に作るつもりのPrefabの名前を返す。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// ここでは、prefab_kohaku とかそういうのを想定している。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return "prefab_" + groupKey;</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>この関数はちょっと難解で、ABGが自動的に作ったテンプレっぽい内容を書き換えて、次のようなことをしている。</p>
<p class="p13"><span class="Apple-tab-span">	</span>・objectsがテクスチャ6枚のセットであること</p>
<p class="p13"><span class="Apple-tab-span">	</span>・もしそうだったら、”prefab_” + groupKey という文字列を返すこと</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>最後に返しているstringは、「無事にprefabが生成されたらこの名前にする」というパラメータになっている。</p>
<p class="p13"><span class="Apple-tab-span">	</span>で、groupKeyという引数には、今回の構成の場合、さきほどGroupingで分けた、「kohaku」「misaki」「yuko」という文字列が入ってくる。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>Groupingした素材のグループ観で切り分けられたリソースに対して、対応するようにこの関数が呼ばれるのだ。</p>
<p class="p13"><span class="Apple-tab-span">	</span>これによって、</p>
<p class="p13"><span class="Apple-tab-span">	</span>1.グループを作る</p>
<p class="p13"><span class="Apple-tab-span">	</span>2.グループに対して処理をする(特にこの場合prefabを作る)</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>ということが大変やりやすくなっている。</p>
<p class="p14"><br></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>で、次にCreatePrefab関数の中身を見よう。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>/**</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span> * Create Prefab.</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span> */<span class="Apple-converted-space"> </span></span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>public UnityEngine.GameObject CreatePrefab (string groupKey, List&lt;UnityEngine.Object&gt; objects) {</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// objectsの中身はTexture2Dなので、UnityEngine.ObjectからTexture2Dに変換する。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var textures = new Texture2D[6];</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>for (var i = 0; i &lt; objects.Count; i++) {</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>var obj = objects[i];</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>textures[i] = obj as Texture2D;</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// GameObjectを作成する。ここではCubeが好きなのでCubeを作る。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>GameObject go = GameObject.CreatePrimitive(PrimitiveType.Cube);</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// 今回Texture2Dを６枚セットする対象のスクリプトを、goにくっつける。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>MyCubeScript myCubeScr = go.AddComponent&lt;MyCubeScript&gt;();</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// myCubeScrのtextures(Texture2DのArray)に、ダイレクトにセット。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>myCubeScr.textures = textures;</span></p>
<p class="p16"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>/*</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>最終的にGameObjectを返すと、そのGameObjectが自動的にPrefabになる！<span class="Apple-converted-space"> </span></span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>わあPrefabできちゃったよ。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>名前はCanCreatePrefab関数で返したものが使われる。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>*/</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>return go;</span></p>
<p class="p16"><span class="s3"></span><br></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>// そしてなんと、このGameObjectはこのあと自動的に消去される。</span></p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span>}</span></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>やっていることは、ものすごくダイレクトな感じ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>・ローカル変数 Texture2D[] texturesを作り、CreatePrefab関数の引数 objects として流れてくるAssets(全部Texture2Dのインスタンス)をセットする</p>
<p class="p13"><span class="Apple-tab-span">	</span>・GameObjectを作ってMyCubeScriptをAddして、</p>
<p class="p13"><span class="Apple-tab-span">	</span>・myCubeScrのtexturesというインスタンスに、冒頭で作ったtexturesをセット。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>これで、あとはGameObject goを、この関数の返り値としてreturnするだけ。</p>
<p class="p13"><span class="Apple-tab-span">	</span>するだけで、GameObject goは勝手に、<b>キャラのテクスチャ6枚を含んだtextures配列 を持ったMyCubeScript がセットされた prefab</b>になる。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>このprefab、特にExportする先をExporterノードなどで指定しなければ、ABGのキャッシュ内に出力される。</p>
<p class="p13"><span class="Apple-tab-span">	</span>具体的にいうと次の図のようなところに吐かれる。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.04.03.png" alt="スクリーンショット 2016-12-22 3.04.03.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>で、内容を確認してみると、、</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.04.12.png" alt="スクリーンショット 2016-12-22 3.04.12.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>ちゃんと全キャラ全テクスチャがprefabとして計3キャラ分、全部セットされてる。やったぜ！</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>どうだろうか。</p>
<p class="p13"><span class="Apple-tab-span">	</span>いままで手で書いてたコード、毎回構築していたルール、みたいなのと比べて、楽じゃねーかな？</p>
<p class="p13"><span class="Apple-tab-span">	</span>素材を増やしたら勝手に種類が増えるし、スクリプトさえ変えれば処理も全部変化させられる。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>複数のPrefabを作るにはどうすればいいのか？とかは、多分複数のPrefabBuilderを用意すればいいんじゃないかな～と思う。</p>
<p class="p14"><br></p>
<p class="p14"><br></p>
<p class="p12"><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/tree/%23%E3%83%97%E3%83%A9%E3%83%83%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%A6%E3%82%B3%E3%83%9E%E3%83%B3%E3%83%89%E3%83%A9%E3%82%A4%E3%83%B3%E3%81%8B%E3%82%89%E8%B5%B7%E5%8B%95"><b>プラットフォーム指定してコマンドラインから起動</b></a></p>
<p class="p13"><span class="Apple-tab-span">	</span>これは比較的お手軽な方法が新規に実装されていて自分もビビった。</p>
<p class="p13"><span class="Apple-tab-span">	</span>CIとかで実行したいじゃないですか。AssetBundle作るのとかそのへん。</p>
<p class="p13"><span class="Apple-tab-span">	</span>というわけで実行できるし、実行するためのshellとかbatとかも生成できるんだよ、ABG。ホントびっくりだよ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>メニューバー &gt; Window &gt; AssetBundleGraph &gt; Create CUI Tool を押すと、Macの場合shellが、Winの場合batが出力される。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%2023.29.20.png" alt="スクリーンショット 2016-12-22 23.29.20.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>もちろん実行可能なやつ。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>出力される場所は下記になる。</p>
<p class="p13"><span class="Apple-tab-span">	</span>Assets/AssetBundleGraph/Generated/CUI/buildassetbundle.sh</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%2023.33.16.png" alt="スクリーンショット 2016-12-22 23.33.16.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>で、今回のサンプルでは、適当なグラフを用意したのと、それをプラットフォーム指定付きで実行するラッパーっぽいshellを用意した。</p>
<p class="p14"><br></p>
<p class="p13"><b><span class="Apple-tab-span">	</span>build_iOS_and_Android.sh<span class="Apple-converted-space"> </span></b></p>
<p class="p17">sh Assets/AssetBundleGraph/Generated/CUI/buildassetbundle.sh -target iOS</p>
<p class="p17">sh Assets/AssetBundleGraph/Generated/CUI/buildassetbundle.sh -target Android</p>
<p class="p14"><br></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>ABGの方ではどんなグラフを書いたかは、リポジトリ落としてGUIで見てもらうとして。</p>
<p class="p13"><span class="Apple-tab-span">	</span>もうなんとなく察しはついたでしょ？ -target でiOSとかAndroidとか書けば、対応するプラットフォーム向けにABGを動かしてくれるのよこの<span class="s4">buildassetbundle.sh</span>が。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>プロジェクトフォルダ直下(Assetsフォルダと同階層)にあるExportパスを眺めながら、</p>
<p class="p13"><span class="Apple-tab-span">	</span>build_iOS_and_Android.shを実行してみてほしい。</p>
<p class="p13"><span class="Apple-tab-span">	</span>画像だとまずOSX版のAssetBundleを作っていたのを忘れてて、OSXフォルダがあるけど無視して。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%2023.51.58.png" alt="スクリーンショット 2016-12-22 23.51.58.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>しばらくするとiOSフォルダが生成され、中身がモリモリ出てくる。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%200.07.20.png" alt="スクリーンショット 2016-12-23 0.07.20.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>さらに待つと、 Androidフォルダが生成され、やはり中身がモリモリする。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%200.14.35.png" alt="スクリーンショット 2016-12-23 0.14.35.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>ね。簡単でしょ(ボブ</p>
<p class="p14"><br></p>
<p class="p14"><br></p>
<p class="p12"><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/tree/%23%E5%AE%8C%E4%BA%86%E5%BE%8C%E3%81%AB%E7%8B%AC%E8%87%AA%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%86">完了後に独自の処理を行う</a></p>
<p class="p13"><span class="Apple-tab-span">	</span>AssetBundleを作るのには、お世辞じゃないけど量に比例した時間がかかる。</p>
<p class="p13"><span class="Apple-tab-span">	</span>やっぱりこれは変わらない。高速に実行するにはスペックで殴ったりキャッシュを効かせるのがいちばんいい。</p>
<p class="p13"><span class="Apple-tab-span">	</span>で、時間がかかる処理なら、CIサーバとかで実行したい。そして完了したら通知が飛んでほしい。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>というわけで「ABGの動作完了に合わせて、通知が飛んでくる」みたいなサンプルを用意した。</p>
<p class="p13"><span class="Apple-tab-span">	</span>もちろん、ABGにはそのためのハンドラもある。全て熟知！！</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>メニューバー &gt; Window &gt; AssetBundleGraph &gt; Create Node Script &gt; Postprocess Script</p>
<p class="p13"><span class="Apple-tab-span">	</span>で、ABGに関してのpostprocessのハンドラを含んだコードが出力される。</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%2024.47.53.png" alt="スクリーンショット 2016-12-22 24.47.53.png"></p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>出力場所はここ。 Assets/AssetBundleGraph/Generated/Editor フォルダ</p>
<p class="p13"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%2024.48.34.png" alt="スクリーンショット 2016-12-22 24.48.34.png"></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>で、内容に関してはリポジトリを見てほしい。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>MyPostprocess.cs</p>
<p class="p13"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/blob/%23%E5%AE%8C%E4%BA%86%E5%BE%8C%E3%81%AB%E7%8B%AC%E8%87%AA%E3%81%AE%E5%87%A6%E7%90%86%E3%82%92%E8%A1%8C%E3%81%86/Assets/AssetBundleGraph/Generated/Editor/MyPostprocess.cs">https://github.com/sassembla/Advent2016_AssetBundleGraph/blob/%23完了後に独自の処理を行う/Assets/AssetBundleGraph/Generated/Editor/MyPostprocess.cs</a></p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>特にハンドラメソッド Runの末尾で、ビルドが終わった後に行う処理をC#で記述することができる。</p>
<p class="p13"><span class="Apple-tab-span">	</span>このハンドラの引数には、「どのノードでどのAssetが処理されたか」を網羅する情報 <b>assetGroups</b> が入っているので、その情報を使ってビルド結果を通知することができる。</p>
<p class="p14"><br></p>
<p class="p14"><br></p>
<p class="p12"><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/tree/%23variants%E3%81%A7AB%E3%81%AE%E4%B8%AD%E8%BA%AB%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B">variantsでABの中身を指定する</a></p>
<p class="p13"><span class="Apple-tab-span">	</span>というわけでvariantsを使ってAssetBundleの中身を制御するとか、まあ、そういうアレ。</p>
<p class="p13"><span class="Apple-tab-span">	</span>サンプルとしては次のような要件を定義した。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>・英語用の素材 en と、日本語用の素材 jp の2種のAssetを用意</p>
<p class="p13"><span class="Apple-tab-span">	</span>・それぞれen、jp というvariantsを用意し、enを選んだら英語、jpを選んだら日本語用のAssetBundleを使えば良い、という状態を作る</p>
<p class="p13"><span class="Apple-tab-span">	</span>・キャラ数分、3種類のAssetBundleを作る</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>ようは<span class="s5"><b>ロ</b></span><span class="s6"><b>ー</b></span><span class="s7"><b>カ</b></span><span class="s8"><b>ラ</b></span><span class="s9"><b>イ</b></span><span class="s10"><b>ズ</b></span>です。はい。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>素材を次のようなフォルダ構成で用意。platform_enと、platform_jp という名前で各素材のフォルダを切った。</p>
<p class="p18"><span class="s11"><span class="Apple-tab-span">	</span></span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%202.30.25.png" alt="スクリーンショット 2016-12-23 2.30.25.png"></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span>en</span>とjpの内容については、今回は全く同じフォルダ名で、これまた全く同じファイル名の画像を用意している。</p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span>variants</span>で差し替えられる素材の条件として、「全く同じファイル名」という条件があるので、画像のファイル名は必然的にこうなる。</p>
<p class="p19"><span class="Apple-tab-span">	</span></p>
<p class="p19"><br></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span></span>早速次のようなグラフを構築してみる。</p>
<p class="p18"><span class="Apple-tab-span">	</span>Loader &gt; Filter &gt; Grouping1,2 . BundleConfig &gt; BundleBuilder &gt; Exporter</p>
<p class="p18"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%202.32.14.png" alt="スクリーンショット 2016-12-23 2.32.14.png"></p>
<p class="p19"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span>Loader</span>で読み込んだ画像群を、まず<span class="s12">Filter</span>でjpとenに分割している。</p>
<p class="p13"><span class="Apple-tab-span">	</span>Filterからの出力先では、各3キャラクターそれぞれのAssetをAssetBundleにするため、Groupingを挟んでグループ化。</p>
<p class="p19"><br></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span></span>で、<span class="s12">BundleConfig</span>ノード。こいつは大変シンプルな設定でものすごいことになっている。</p>
<p class="p13"><span class="Apple-tab-span">	</span>入り口が3つあるやんけ。しかもjpとかenとか振ってあるやんけ。</p>
<p class="p18"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%202.32.34.png" alt="スクリーンショット 2016-12-23 2.32.34.png"></p>
<p class="p19"><span class="Apple-tab-span">	</span></p>
<p class="p18"><span class="Apple-tab-span">	</span>BundleConfig<span class="s11">の</span>Inspector<span class="s11">がこちら。</span></p>
<p class="p18"><span class="Apple-tab-span">	</span><span class="s11">・</span>variants<span class="s11">がセットしてある</span></p>
<p class="p18"><span class="Apple-tab-span">	</span><span class="s11">・</span>jp<span class="s11">と</span>en<span class="s11">の</span>2<span class="s11">つ</span></p>
<p class="p18"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%202.32.39.png" alt="スクリーンショット 2016-12-23 2.32.39.png"></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span></span>これで。これだけで。</p>
<p class="p14"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="Apple-tab-span">	</span>BundleConfigに流れ込んでくるAssetに対して、variantsをセットして、同名のものがきちんと存在していれば、</p>
<p class="p13"><span class="Apple-tab-span">	</span>variantsを含んだAssetBundleとしてビルドしてくれるんだよ。</p>
<p class="p19"><span class="Apple-tab-span">	</span></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span></span>すごい。</p>
<p class="p19"><br></p>
<p class="p13"><span class="s12"><span class="Apple-tab-span">	</span></span>で、ABGをビルドした結果はこちら。</p>
<p class="p18"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-23%202.32.40.png" alt="スクリーンショット 2016-12-23 2.32.40.png"></p>
<p class="p13"><span class="Apple-tab-span">	</span>はい、.enとか.jpとかできてますね。</p>
<p class="p14"><br></p>
<p class="p13"><span class="Apple-tab-span">	</span>manifestを見ると、いい感じになっている。</p>
<p class="p14"><br></p>
<p class="p14"><br></p>
<p class="p12"><a href="https://github.com/sassembla/Advent2016_AssetBundleGraph/tree/%23%E3%83%97%E3%83%A9%E3%83%83%E3%83%88%E3%83%95%E3%82%A9%E3%83%BC%E3%83%A0%E3%81%94%E3%81%A8%E3%81%AB%E7%95%B0%E3%81%AA%E3%82%8B%E7%B4%A0%E6%9D%90%E3%82%84importSettings%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B">プラットフォームごとに異なる素材やimportSettingsを指定する</a></p>
<p class="p10"><span class="Apple-tab-span">	</span>ほら、画像とかモデルとかオーディオとかだと、Inspectorからインポート時の設定をプラットフォームごとにセットできるじゃない。</p>
<p class="p10"><span class="Apple-tab-span">	</span>AssetBundleGraphもそれができるよっていうやつ。しかももっとダイナミックな範囲で。</p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span>まずこのLoaderをみてくれ。こいつをどう思う。</p>
<p class="p20"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.31.22.png" alt="スクリーンショット 2016-12-22 3.31.22.png"></p>
<p class="p21"><br></p>
<p class="p21"><br></p>
<p class="p20"><span class="Apple-tab-span">	</span>Loader<span class="s11">ノードの</span>Inspector<span class="s11">はこんな感じ。</span></p>
<p class="p10"><span class="Apple-tab-span">	</span>まあデフォルトでAssets/Game/Images/PNG_iOS っていうフォルダから画像読み出そうとするじゃない。</p>
<p class="p20"><span class="s11"><span class="Apple-tab-span">	</span></span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.33.15.png" alt="スクリーンショット 2016-12-22 3.33.15.png"></p>
<p class="p21"><br></p>
<p class="p10"><span class="s12"><span class="Apple-tab-span">	</span></span>アイコンがあるよね～～ってことは、そう、「もしこのプラットフォーム設定でABGを動かしたら、この設定が使われるよ」ってこと。シンプルかつ強力。</p>
<p class="p20"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.33.24.png" alt="スクリーンショット 2016-12-22 3.33.24.png"></p>
<p class="p21"><br></p>
<p class="p21"><br></p>
<p class="p10"><span class="s12"><span class="Apple-tab-span">	</span></span>で、プラットフォームの指定は<span class="s12">ABG</span>の上部のバーのところをクリックすると、なんかいろいろプラットフォーム選択肢が出てくる。</p>
<p class="p20"><span class="Apple-tab-span">	</span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.34.28.png" alt="スクリーンショット 2016-12-22 3.34.28.png"></p>
<p class="p21"><br></p>
<p class="p10"><span class="s12"><span class="Apple-tab-span">	</span></span>たとえばiOSとAndroidで別の画像素材を使って、別のImportSettingを適応させたい場合、次のようなグラフを書く。</p>
<p class="p20"><span class="Apple-tab-span">	</span>Loader<span class="s11">ノードと</span>ImportSettings<span class="s11">ノードが一つずつ。</span></p>
<p class="p20"><span class="s11"><span class="Apple-tab-span">	</span></span><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202016-12-22%203.34.34.png" alt="スクリーンショット 2016-12-22 3.34.34.png"></p>
<p class="p21"><br></p>
<p class="p10"><span class="s12"><span class="Apple-tab-span">	</span></span>この状態で、Loaderノードに<span class="s12">iOS/Android</span>それぞれの素材パスを書いて、</p>
<p class="p10"><span class="s12"><span class="Apple-tab-span">	</span>ImportSettings</span>ノードに「iOSだったらこう」「Androidだったらこう」という設定をセットするだけ。</p>
<p class="p21"><span class="Apple-tab-span">	</span></p>
<p class="p10"><span class="s12"><span class="Apple-tab-span">	</span></span>ね、簡単でしょ。</p>
<p class="p21"><span class="Apple-tab-span">	</span></p>
<p class="p11"><br></p>
<p class="p10"><b>おわったああああああああ</b></p>
<p class="p10"><span class="Apple-tab-span">	</span>良いお年を。なんか質問とかバグみっけたよとかあったら教えて、、くだ、、さ、、</p>
<p class="p10"><span class="Apple-tab-span">	</span>明日は<a href="http://qiita.com/murapong">murapong</a>さんの、[Unity Cloud Buildのビルド結果をHipChatに通知するには]です。</p>
<p class="p11"><br></p>
<p class="p10"><span class="Apple-tab-span">	</span><a href="http://qiita.com/advent-calendar/2016/unity2">http://qiita.com/advent-calendar/2016/unity2</a><span class="Apple-tab-span">	</span></p>
</body>
</html>
