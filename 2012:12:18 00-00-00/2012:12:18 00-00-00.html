<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1187.34">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Kaku Gothic ProN'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Hiragino Kaku Gothic ProN'}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Helvetica Neue'; color: #323333}
    p.p6 {margin: 0.0px 0.0px 16.0px 0.0px; font: 20.0px 'Hiragino Kaku Gothic Pro'}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; background-color: #d6d6d6}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; background-color: #d6d6d6; min-height: 18.0px}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 13.0px 'Hiragino Kaku Gothic ProN'; color: #232323}
    span.s1 {color: #ff4013}
    span.s2 {font: 12.0px 'Hiragino Kaku Gothic ProN'}
    span.s3 {font: 13.0px 'Hiragino Kaku Gothic ProN'}
    span.s4 {font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #000000}
    span.s5 {font: 12.0px Helvetica}
    span.s6 {font: 13.0px Arial}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><b>主に</b><span class="s1"><b>LL</b></span><b>VMを使用しています</b></p>
<p class="p2"><br></p>
<p class="p3"><b>概要</b></p>
<p class="p4"><span class="s2"><span class="Apple-tab-span">	</span><a href="http://partake.in/events/9658f376-6ce3-4217-b392-b05d3de60021"><span class="s3">http://partake.in/events/9658f376-6ce3-4217-b392-b05d3de60021</span></a></span></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p5"><span class="s4"><span class="Apple-tab-span">	</span>昨日は </span>@yusuke_kokubo<span class="s4"> さんでした。</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>りあじゅうばくはつしろ！</p>
<p class="p2"><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>で</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>LLとかMLという語句がついてればOKだと思うので、</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>今回は</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p6">＿人人人人人人人人人人＿<br>
＞　突然のemscripten　＜<br>
￣^Y^Y^Y^Y^Y^Y^Y^Y^￣</p>
<p class="p2"><br></p>
<p class="p3"><b>emscriptenとは</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>OCamlでJSやるのとかありますよね。　いいですよね！！ JS書かずにすむとかGooooodです。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>emscriptenは、</p>
<p class="p3"><span class="Apple-tab-span">	</span>その辺の<b>「こんな言語からJSが生成されるなんて！！」的な言語のお友達</b>です。</p>
<p class="p3"><span class="Apple-tab-span">	</span>こわくない。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>Q.どこがMLだったりLLなのか</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>A.</b><span class="s1"><b>LL</b></span><b>VMです。 JS生成に</b><span class="s1"><b>LL</b></span><b>VMを使用しています。</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>emscriptenは、LLVMを使って、いろんな言語のコンパイル結果として<b>JSを吐き出します</b>。</p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>毎回なぜかこの辺でドン引きされますが、</p>
<p class="p3"><span class="Apple-tab-span">	</span>コワくない。</p>
<p class="p2"><b></b><br></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>本体</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>githubにホストして開発されてる</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://github.com/kripken/emscripten/wiki">https://github.com/kripken/emscripten/wiki</a></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>わかりやすい日本語での解説</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Emscriptenの論文読んだ。Webの賢い選択。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://akidev.hateblo.jp/entry/2012/04/12/233934">http://akidev.hateblo.jp/entry/2012/04/12/233934</a></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>自分も5月くらいになんか書いてました。もう古い。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>emscriptenを動かしてみる</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://sassembla.github.com/Public/12:05:21%2017-38-30/12:05:21%2017-38-30.html">http://sassembla.github.com/Public/12:05:21%2017-38-30/12:05:21%2017-38-30.html</a></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>補足<span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b>LLVMって？</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>コレ。　コンパイラみたいなものです。</p>
<p class="p3"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b><a href="http://llvm.org">http://llvm.org</a></p>
<p class="p2"><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>やってみよう！</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>今回は、Objective-CのコードをJS化してみるよ！</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>といってもヘビー級だと絶対破滅するので、</p>
<p class="p3"><span class="Apple-tab-span">	</span>軽めのをソースからJS化してみます。</p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>脱線するけど。</b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>本来の「言語をコンパイル可能な状況に持ち込む事で、出来るとうれしい事は何か」；</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>1.メッセージングの機構とか、JSでやるとクソみたいな事を、Cとかで書いてJSに持ち込む</b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>2.人の手が絶対につけられないJSソースコードを吐く（マイナーチェンジや場当たりなど、変更可能性の更迭）</b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>3.テストが容易</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>2.3が絶大なメリットだと思ってて、</p>
<p class="p3"><span class="Apple-tab-span">	</span>変更可能性の無い = 人間が弄れない、なんだけど、</p>
<p class="p3"><span class="Apple-tab-span">	</span>そういうソースコードでなにかをコントロールする世界にしていかないと、Webまわりはもうずっとこのままだと思う。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>外部化のために、変更可能性をより上部に持っていく必要を感じているのです。</p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>で、手順！</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>MacでClangをインストール</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>Xcodeから入れると、フレームワークとかのパス設定をはしょれて凄く楽です。</p>
<p class="p3"><span class="Apple-tab-span">	</span>Xcode &gt; Preferences &gt; Downloads &gt;<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>最初llvm自体をDLして、ガチで挑んで死ぬかと思いました。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>Windowsでも調べてみたら相ッ当なドMな方だとお見受けしますが、</p>
<p class="p3"><span class="Apple-tab-span">	</span>何人か「環境作ってみたぜ！」な方々がいらっしゃいました。正直koeee。</p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>Cの簡単なファイルを試しに一発ビルド<span class="Apple-tab-span">	</span></b></p>
<p class="p3"><span class="Apple-tab-span">	</span>対象のファイルはこんな感じ。</p>
<p class="p2"><br></p>
<p class="p3">test.c</p>
<p class="p7">#include &lt;stdio.h&gt;</p>
<p class="p7">int main()</p>
<p class="p7">{</p>
<p class="p7"><span class="Apple-converted-space">    </span>int i = 0;</p>
<p class="p7"><span class="Apple-tab-span">	</span>for (i = 0; i &lt; 99; i++) printf("hello, world %d\n", i);</p>
<p class="p7"><span class="Apple-converted-space">    </span>return 0;</p>
<p class="p7">}</p>
<p class="p2"><b></b><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>百回hello, world っていうプログラムです。</p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>ビルド</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>llvmは、clangというフロントエンドツールを介してコントロールします。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ビルドコマンドは</p>
<p class="p3"><span class="Apple-tab-span">	</span>clang test.c -v</p>
<p class="p3"><span class="Apple-tab-span">	</span>↓</p>
<p class="p8"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202012-12-18%2022.29.04.png" alt="スクリーンショット 2012-12-18 22.29.04.png"></p>
<p class="p3"><span class="Apple-tab-span">	</span>成果としてa.outができましたよっと。</p>
<p class="p2"><br></p>
<p class="p8"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202012-12-18%2022.29.26.png" alt="スクリーンショット 2012-12-18 22.29.26.png"></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>Obj-Cの簡単なファイルを試しに一発ビルド<span class="Apple-tab-span">	</span></b></p>
<p class="p3"><span class="Apple-tab-span">	</span>対象のファイルはこんな感じ</p>
<p class="p2"><br></p>
<p class="p3">test.m</p>
<p class="p7">#import &lt;Foundation/Foundation.h&gt;</p>
<p class="p9"><br></p>
<p class="p7">@interface X : NSObject</p>
<p class="p7">@end</p>
<p class="p9"><br></p>
<p class="p7">@implementation X</p>
<p class="p7">-(void)hello {</p>
<p class="p7"><span class="Apple-converted-space">       </span>printf("Hello\n");</p>
<p class="p7">}</p>
<p class="p9"><br></p>
<p class="p7">@end</p>
<p class="p9"><br></p>
<p class="p7">int main() {</p>
<p class="p7"><span class="Apple-tab-span">	</span>X * obj = [[X alloc] init];</p>
<p class="p7"><span class="Apple-converted-space">  <span class="Apple-tab-span">	</span></span>[obj hello];</p>
<p class="p7"><span class="Apple-converted-space">    </span>return 0;</p>
<p class="p7">}</p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>ビルド</b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span></b>clang<span class="Apple-converted-space">  </span>-fobjc-arc -framework Foundation test.m -o testObjC.out</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>↓</p>
<p class="p3"><span class="Apple-tab-span">	</span>出来上がったバイナリを実行すると、</p>
<p class="p8"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202012-12-21%206.23.45.png" alt="スクリーンショット 2012-12-21 6.23.45.png"></p>
<p class="p2"><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>ビルドできる環境が整ったら、.ll/.bcファイルを出力</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>emscriptenに喰わせるための、LLVM bitcode file を生成する。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ちょっと脱線しつつ説明しておくと、</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>llvmは「ローレベルなバーチャルマシンで色んな事をする為のコンパイルの基盤」で、</p>
<p class="p3"><span class="Apple-tab-span">	</span>その目的は</p>
<p class="p3"><span class="Apple-tab-span">	</span>・言語をビルドする行為それ自体と、ビルドしたものが実際に動作するアーキテクチャを切り離す</p>
<p class="p3"><span class="Apple-tab-span">	</span>・中間言語の時点で最適化を施す</p>
<p class="p3"><span class="Apple-tab-span">	</span>というもの。超ザックリ。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>で、.ll/.bcファイルは、まさにその中間言語化された状態のcompiledな状態。</p>
<p class="p3"><span class="Apple-tab-span">	</span>実行形式を引きずってない、意図だけのソース。</p>
<p class="p3"><span class="Apple-tab-span">	</span>その辺をclangからつくる。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>clang -O3 -emit-llvm test.m -c -o test.bc</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>こんなのが出来る。</p>
<p class="p8"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202012-12-18%2023.53.50.png" alt="スクリーンショット 2012-12-18 23.53.50.png"></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>emscriptenのセットアップ</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>割愛。</p>
<p class="p3"><span class="Apple-tab-span">	</span>参考になるステキな記事。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>c/c++ -&gt; javascript 変換compiler - emscripten を試す</b></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://d.hatena.ne.jp/end0tknr/20120714/1342233561">http://d.hatena.ne.jp/end0tknr/20120714/1342233561</a></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>作成した中間言語をemsriptenでjs化</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>C言語版</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>./emscripten/emcc ソース</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>出力されるのが、.jsファイル。</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>-o 出力ファイル名　とかで調整も可能。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Cオリジナル</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://dl.dropbox.com/u/36583594/shared/test/test.c">https://dl.dropbox.com/u/36583594/shared/test/test.c</a></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>js化したものをhtmlに入れたヤツ</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://dl.dropbox.com/u/36583594/shared/test/test.html">https://dl.dropbox.com/u/36583594/shared/test/test.html</a></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Cのprintfに対応して、プリント文が出てるぞ！！ デバッガを見てね！</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="s5"><img src="%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88%202012-12-19%200.34.15.png" alt="スクリーンショット 2012-12-19 0.34.15.png"></span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>Obj-C版</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>オリジナル</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="https://dl.dropbox.com/u/36583594/shared/test/test.m">https://dl.dropbox.com/u/36583594/shared/test/test.m</a></p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>★最新のemsだと、.llからの変換が駄目らしい！！！</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>調整中、、2012/12/18 23:57:43</p>
<p class="p2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p5"><span class="s4">明日は </span>@kei10in <span class="s3">さんです。</span></p>
<p class="p2"><br></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><b>番外編</b>：<b>失敗狂の詩</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>何手か、悪手っぽいものを試して失敗したのでメモまでに。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>Obj-Cから<span class="s5">c++</span>とかに変換すればいいんじゃね？</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p10"><span class="s4"><b><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></b></span><span class="s6"><b>clang</b></span><b> </b><span class="s6"><b>-rewrite-objc </b></span><b>で</b><span class="s6"><b>.m</b></span><b>ファイルを</b><span class="s6"><b>cpp</b></span><b>ファイルに変換できる</b>ので、それをビルドすれば、、！！という。</p>
<p class="p10"><span class="s6"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>アイデア自体はまあ平和だったんですが、詰まったので方向転換しました。</p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>以下メモ</b></p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>emscripten側を弄る</b></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>・設定ファイルを更新</b></p>
<p class="p3"><b>LLVM_ROOT = os.path.expanduser(os.getenv('LLVM') or '/usr/bin/')</b></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>llvm-linkとllvm-arとoptとllvm-asとllvm-disと</b></p>
<p class="p3"><b>llvm-nmを追加</b></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>で、</b></p>
<p class="p2"><b></b><br></p>
<p class="p3">./emscripten/emcc /Users/sassembla/test/ems/test.m.cpp</p>
<p class="p3">(Emscripten: settings file has changed, clearing cache)</p>
<p class="p3">warning: LLVM version appears incorrect (seeing "Apple clang version 4.1 (tags/Apple/clang-421.11.66) (based on LLVM 3.1svn)", expected "clang version 3.1")</p>
<p class="p3">(Emscripten: Running sanity checks)</p>
<p class="p3">/Users/sassembla/test/ems/test.m.cpp:69:9: warning: '__block' macro redefined</p>
<p class="p3">#define __block</p>
<p class="p3"><span class="Apple-converted-space">        </span>^</p>
<p class="p3">&lt;built-in&gt;:20:9: note: previous definition is here</p>
<p class="p3">#define __block __attribute__((__blocks__(byref)))</p>
<p class="p3"><span class="Apple-converted-space">        </span>^</p>
<p class="p3">/Users/sassembla/test/ems/test.m.cpp:73:10: fatal error:<span class="Apple-converted-space"> </span></p>
<p class="p3"><span class="Apple-converted-space">      </span>'Foundation/Foundation.h' file not found</p>
<p class="p3">#include &lt;Foundation/Foundation.h&gt;</p>
<p class="p3"><span class="Apple-converted-space">         </span>^</p>
<p class="p3">1 warning and 1 error generated.</p>
<p class="p3">emcc: compiler frontend failed to generate LLVM bitcode, halting</p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>なので、</b></p>
<p class="p3"><b>frameworkを読むように設定して、</b></p>
<p class="p2"><br></p>
<p class="p3">./emscripten/emcc -framework /System/Library/Frameworks/Foundation.framework/Headers/Foundation.h /Users/sassembla/test/ems/test.m.cpp -o a.out.js</p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>おおーエラー無く出せた。</b></p>
<p class="p3"><b>でもこれ何が出てるんだろう。。。</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>↓</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>CPPがそのまま吐かれてた</b></p>
<p class="p3"><b>グハー</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>ということで、このルートは無し。</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>再度チャレンジ</b></p>
<p class="p2"><b></b><br></p>
<p class="p3">./emscripten/emcc -framework<span class="Apple-converted-space">  </span>/Users/sassembla/test/ems/test.m.cpp -o a.out.js</p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>llvmが吐き出す中間成果物をもとに、emscriptenしてみる</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>llvm-dis</b></p>
<p class="p3"><b>llvm-dis /Users/sassembla/Desktop/compile/test.bc</b></p>
</body>
</html>
