<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1265.21">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Kaku Gothic ProN'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><b>UnityがPlayMode起動中かどうかをメインスレッド外から見分ける方法</b></p>
<p class="p2"><br></p>
<p class="p3"><b>概要</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>メインスレッドだろうと、UnityがPlayMode起動中かどうかは判断できない(compile中なのでisCompilingにはなる)ので、</p>
<p class="p3"><span class="Apple-tab-span">	</span>わりと有益な感じ。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>マルチスレッドなエディタコードとかで効率化計ってて、PlayMode起動に入ったら即なにかを開始する、みたいなエディタコードで適応したい。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>方法</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>プロジェクト内にUnityが特定のファイルを作り出すのを利用する。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span><b>PROJECT_FOLDER/Temp/__EditModeScene</b> の有無でチェックができる。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>プレイモードを起動 → 存在しない場合新規作成される</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span> → 存在する場合上書きする</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>Unity 4.6.1系で確認済み。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>が、このデータは、「Unityがクラッシュした際に復旧する最後の手段」でもある。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>参考：テラシュールウェア</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>Unityエディタのクラッシュ時に失われたシーン情報を復旧させる裏ワザ</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://tsubakit1.hateblo.jp/entry/2014/10/20/230851">http://tsubakit1.hateblo.jp/entry/2014/10/20/230851</a></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>つまり俺都合で勝手に消したりすると殺意の波動にやられる。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ので、消す訳にはいかず、タイムスタンプのみを切り出して別途保存する形で扱う。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>・プレイモード or 単なるコンパイルが発生したあと、エディタ側コードの起動が発生する</p>
<p class="p3"><span class="Apple-tab-span">	</span>・起動後、適当なタイミングや適当なスレッドで <b>__EditModeScene </b>のタイムスタンプをチェック</p>
<p class="p3"><span class="Apple-tab-span">	</span>・以前のものと異なるようであればプレイモード開始中！</p>
<p class="p3"><span class="Apple-tab-span">	</span>・以前のものと同じであれば、単なるコンパイル</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>という区別が出来る。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>弱点</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>モロにUnityのversionに左右されるんじゃないだろうか。</p>
<p class="p3"><span class="Apple-tab-span">	</span>あと別に、エディタメニューをコードから実行する形で隠蔽、フラッグをファイルとかに書く、というのも、まあマシで良いと思う。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3">以上。</p>
</body>
</html>
