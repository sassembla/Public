<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1504.83">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Kaku Gothic ProN'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #28f0ef; background-color: #ffffff}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #28f0ef}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #28f0ef; background-color: #ffffff; min-height: 18.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #000000; background-color: #ffffff; min-height: 18.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #000000; background-color: #ffffff}
    span.s1 {font-kerning: none}
    span.s2 {font-variant-ligatures: no-common-ligatures}
    span.s3 {font-variant-ligatures: no-common-ligatures; background-color: #ffffff}
    span.Apple-tab-span {white-space:pre}
    td.td1 {width: 120.6px; margin: 0.5px 0.5px 0.5px 0.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #dddddd #dddddd #dddddd #dddddd; padding: 6.0px 13.0px 6.0px 13.0px}
    td.td2 {width: 54.2px; margin: 0.5px 0.5px 0.5px 0.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #dddddd #dddddd #dddddd #dddddd; padding: 6.0px 13.0px 6.0px 13.0px}
    td.td3 {width: 120.6px; background-color: #ffffff; margin: 0.5px 0.5px 0.5px 0.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #dddddd #dddddd #dddddd #dddddd; padding: 6.0px 13.0px 6.0px 13.0px}
    td.td4 {width: 54.2px; background-color: #ffffff; margin: 0.5px 0.5px 0.5px 0.5px; border-style: solid; border-width: 1.0px 1.0px 1.0px 1.0px; border-color: #dddddd #dddddd #dddddd #dddddd; padding: 6.0px 13.0px 6.0px 13.0px}
  </style>
</head>
<body>
<p class="p1"><b>BenchmarkDotNetでDisquuunをチューニングした時のメモ</b></p>
<p class="p2"><br></p>
<p class="p3"><b>概要</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>とりあえず適当に。</p>
<p class="p2"><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>デフォ</b></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p3"><span class="s1">BenchmarkDotNet=v0.10.11, OS=macOS 10.12.6 (16G1114) [Darwin 16.7.0]</span></p>
<p class="p3"><span class="s1">Processor=Intel Core i7-7Y75 CPU 1.30GHz, ProcessorCount=4</span></p>
<p class="p3"><span class="s1">.NET Core SDK=2.0.0</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>[Host] <span class="Apple-converted-space">    </span>: .NET Core 2.0.0 (Framework 4.6.00001.0), 64bit RyuJIT</span></p>
<p class="p3"><span class="s1"><span class="Apple-converted-space">  </span>DefaultJob : .NET Core 2.0.0 (Framework 4.6.00001.0), 64bit RyuJIT</span></p>
<p class="p2"><span class="s1"></span><br></p>
<table cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p3"><span class="s1"><b>Method</b></span></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p3"><span class="s1"><b>Mean</b></span></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p3"><span class="s1"><b>Error</b></span></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p3"><span class="s1"><b>StdDev</b></span></p>
      </td>
    </tr>
    <tr>
      <td valign="middle" class="td3">
        <p class="p3"><span class="s1">Take10Connection</span></p>
      </td>
      <td valign="middle" class="td4">
        <p class="p3"><span class="s1">74.96 us</span></p>
      </td>
      <td valign="middle" class="td4">
        <p class="p3"><span class="s1">1.449 us</span></p>
      </td>
      <td valign="middle" class="td4">
        <p class="p3"><span class="s1">1.355 us</span></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>適当に数回動かす。</p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                   </span>Method | <span class="Apple-converted-space">    </span>Mean |<span class="Apple-converted-space">    </span>Error | <span class="Apple-converted-space">  </span>StdDev |</span></p>
<p class="p4"><span class="s2">------------------------- |---------:|---------:|---------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_async | 68.04 us | 28.83 us | 1.629 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async | 72.87 us | 22.36 us | 1.263 us |</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async | 73.63 us | 29.12 us | 1.645 us |</span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                   </span>Method | <span class="Apple-converted-space">    </span>Mean |<span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">------------------------- |---------:|---------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_async | 74.89 us | 16.02 us | 0.9051 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async | 68.70 us | 36.14 us | 2.0421 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async | 70.65 us | 42.91 us | 2.4246 us |</span></p>
<p class="p6"><span class="s2"></span><br></p>
<p class="p4"><span class="s2">2018/01/13 5:32:34</span></p>
<p class="p6"><span class="s2"></span><br></p>
<p class="p6"><span class="s2"></span><br></p>
<p class="p2"><br></p>
<p class="p3"><b>2018/01/13 5:32:40</b></p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                   </span>Method | <span class="Apple-converted-space">    </span>Mean | <span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">------------------------- |---------:|----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_async | 74.17 us | 1.4725 us | 2.1118 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async | 74.60 us | 0.9152 us | 0.8113 us |</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async | 75.57 us | 0.8857 us | 0.8285 us |</span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>フル版、若干高速化できた気がする。まだ気分だけ。</p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                   </span>Method | <span class="Apple-converted-space">    </span>Mean |<span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">------------------------- |---------:|---------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_async | 74.52 us | 1.022 us | 0.7979 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async | 75.39 us | 1.079 us | 1.0091 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async | 78.41 us | 1.518 us | 2.2717 us |</span></p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                      </span>Method | <span class="Apple-converted-space">    </span>Mean |<span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">---------------------------- |---------:|---------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_2sock_async | 141.5 us | 282.3 us | 15.949 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_10sock_async | 143.5 us | 235.4 us | 13.298 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_30sock_async | 167.5 us | 545.8 us | 30.840 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_pipeline | 138.9 us | 134.2 us |<span class="Apple-converted-space">  </span>7.584 us |</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space"> </span>Take_10byte_10sock_pipeline | 140.2 us | 175.1 us |<span class="Apple-converted-space">  </span>9.892 us |</span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ubuntu関係なく動かして検証できそう。</p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                  </span>Method | <span class="Apple-converted-space">    </span>Mean | <span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">------------------------ |---------:|----------:|----------:|</span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">  </span>Take_10byte_2sock_sync | 52.78 us |<span class="Apple-converted-space">  </span>7.275 us | 0.4111 us |</span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>tcpを扱うライブラリなので、基礎的なsyncはまあそのまま速度が計測できるんだけど、asyncの負荷を測るには、というのがまだ正しくない。</p>
<p class="p3"><span class="Apple-tab-span">	</span>内部的な機構の速度を計測するようにしよう。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>遅そうなところでいうと、複数のソケットを切り替えるあたり。</p>
<p class="p3"><span class="Apple-tab-span">	</span>lockを外すことができたら結構変わるのでは感</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>参考</p>
<p class="p3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><a href="http://engineering.grani.jp/entry/2017/07/28/145035">http://engineering.grani.jp/entry/2017/07/28/145035</a></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>hashtable良さそう。</p>
<p class="p2"><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                      </span>Method |<span class="Apple-converted-space">      </span>Mean | <span class="Apple-converted-space">    </span>Error | <span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">---------------------------- |----------:|----------:|-----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>68.21 us |<span class="Apple-converted-space">  </span>10.81 us |<span class="Apple-converted-space">  </span>0.6107 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>64.78 us |<span class="Apple-converted-space">  </span>53.97 us |<span class="Apple-converted-space">  </span>3.0491 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>94.92 us |<span class="Apple-converted-space">  </span>43.23 us |<span class="Apple-converted-space">  </span>2.4424 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_30sock_async | 109.56 us | 418.98 us | 23.6731 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_pipeline | 102.49 us |<span class="Apple-converted-space">  </span>83.99 us |<span class="Apple-converted-space">  </span>4.7454 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>76.44 us |<span class="Apple-converted-space">  </span>33.99 us |<span class="Apple-converted-space">  </span>1.9203 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>77.62 us |<span class="Apple-converted-space">  </span>91.14 us |<span class="Apple-converted-space">  </span>5.1495 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>pipelineが割と高速な気がするのはいいこと。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><b>とりあえずあと追加すべきなのは</b></span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>・足りない場合のソケット追加アラート</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>stackに入った時間とstackしてたものが取り出される時間で、その時間の最長を残す？ 失速していた時間、みたいな。</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>単位時間あたりの失速回数とかでもいいのかな、スレッド使うの嫌だから、発生タイミング関連でなんかできるといいのだが</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                      </span>Method |<span class="Apple-converted-space">      </span>Mean | <span class="Apple-converted-space">    </span>Error | <span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">---------------------------- |----------:|----------:|-----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>69.06 us |<span class="Apple-converted-space">  </span>23.87 us |<span class="Apple-converted-space">  </span>1.3487 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>56.41 us |<span class="Apple-converted-space">  </span>14.25 us |<span class="Apple-converted-space">  </span>0.8050 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>69.36 us |<span class="Apple-converted-space">  </span>38.55 us |<span class="Apple-converted-space">  </span>2.1779 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>72.14 us |<span class="Apple-converted-space">  </span>33.17 us |<span class="Apple-converted-space">  </span>1.8742 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>75.60 us |<span class="Apple-converted-space">  </span>29.17 us |<span class="Apple-converted-space">  </span>1.6484 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>77.12 us |<span class="Apple-converted-space">  </span>10.02 us |<span class="Apple-converted-space">  </span>0.5662 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_pipeline | 103.12 us | 196.04 us | 11.0764 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>-&gt; available(ソケットプールからの紫陽花のソケットの抽選)の書き方変えられるかも。わざわざsocketまで読みにいかなくてもいい的な。</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>やってみた -&gt;<span class="Apple-converted-space"> </span></span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                      </span>Method | <span class="Apple-converted-space">    </span>Mean | <span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">---------------------------- |---------:|----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_2sock_async | 81.98 us | 101.04 us |<span class="Apple-converted-space">  </span>5.709 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_sync | <span class="Apple-converted-space">      </span>NA |<span class="Apple-converted-space">        </span>NA |<span class="Apple-converted-space">        </span>NA |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_10sock_async | 91.41 us | 157.85 us |<span class="Apple-converted-space">  </span>8.919 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_30sock_async | 95.51 us |<span class="Apple-converted-space">  </span>80.68 us |<span class="Apple-converted-space">  </span>4.558 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_pipeline | 99.40 us | 285.53 us | 16.133 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_pipeline | 85.39 us | 145.92 us |<span class="Apple-converted-space">  </span>8.245 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_pipeline | 76.18 us |<span class="Apple-converted-space">  </span>36.68 us |<span class="Apple-converted-space">  </span>2.072 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>遅くなったw</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>やーめよ。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                      </span>Method | <span class="Apple-converted-space">    </span>Mean | <span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">---------------------------- |---------:|----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_2sock_async | 78.41 us |<span class="Apple-converted-space">  </span>44.05 us |<span class="Apple-converted-space">  </span>2.489 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_sync | 57.63 us |<span class="Apple-converted-space">  </span>28.17 us |<span class="Apple-converted-space">  </span>1.592 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_10sock_async | 76.53 us |<span class="Apple-converted-space">  </span>33.12 us |<span class="Apple-converted-space">  </span>1.871 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_30sock_async | 83.94 us |<span class="Apple-converted-space">  </span>28.41 us |<span class="Apple-converted-space">  </span>1.605 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_pipeline | 85.94 us |<span class="Apple-converted-space">  </span>97.83 us |<span class="Apple-converted-space">  </span>5.527 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_pipeline | 84.15 us | 233.62 us | 13.200 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_pipeline | 84.44 us |<span class="Apple-converted-space">  </span>18.17 us |<span class="Apple-converted-space">  </span>1.027 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>パイプライン系に10倍のデータを流すベンチを追加。まとめて送る系の効果はデータ量に対してしっかりと出る。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                      </span>Method |<span class="Apple-converted-space">      </span>Mean |<span class="Apple-converted-space">      </span>Error | <span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">---------------------------- |----------:|-----------:|-----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>81.15 us | <span class="Apple-converted-space">  </span>9.596 us |<span class="Apple-converted-space">  </span>0.5422 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>59.28 us | <span class="Apple-converted-space">  </span>5.387 us |<span class="Apple-converted-space">  </span>0.3044 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>99.69 us | 223.154 us | 12.6086 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>78.28 us |<span class="Apple-converted-space">  </span>36.978 us |<span class="Apple-converted-space">  </span>2.0893 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_2sock_pipeline | 152.23 us |<span class="Apple-converted-space">  </span>40.314 us |<span class="Apple-converted-space">  </span>2.2778 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_pipeline | 156.67 us |<span class="Apple-converted-space">  </span>80.243 us |<span class="Apple-converted-space">  </span>4.5339 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_pipeline | 184.29 us | 272.888 us | 15.4187 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>conoha上のubuntu 4コアで実行したところ、こんな感じ。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean |<span class="Apple-converted-space">      </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|-----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async | 111.04 us | <span class="Apple-converted-space">  </span>131.1 us |<span class="Apple-converted-space">  </span>7.406 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>80.81 us | <span class="Apple-converted-space">  </span>108.5 us |<span class="Apple-converted-space">  </span>6.132 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async | 130.34 us | <span class="Apple-converted-space">  </span>304.1 us | 17.181 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async | 116.58 us | <span class="Apple-converted-space">  </span>310.2 us | 17.529 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 895.81 us | 1,387.7 us | 78.405 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 343.30 us | <span class="Apple-converted-space">  </span>582.9 us | 32.935 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 373.80 us | <span class="Apple-converted-space">  </span>321.7 us | 18.178 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline | 131.05 us | <span class="Apple-converted-space">  </span>168.6 us |<span class="Apple-converted-space">  </span>9.528 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline | 129.62 us | <span class="Apple-converted-space">  </span>244.6 us | 13.823 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline | 134.58 us | <span class="Apple-converted-space">  </span>187.4 us | 10.586 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 299.17 us | <span class="Apple-converted-space">  </span>413.9 us | 23.386 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 273.35 us | <span class="Apple-converted-space">  </span>382.1 us | 21.588 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 298.77 us | <span class="Apple-converted-space">  </span>276.1 us | 15.601 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"><span class="Apple-tab-span">	</span></span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>こんな感じか。</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>async系は軒並みWaitHandleのペナルティを負ってるんで、それでこのスコアならいい感じなのでは。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>ここで、tcpソケットを実用しない、ロジックのみの実装版が完成。</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>ほぼ何もしないソケットだと動作速度はこんな感じ。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean |<span class="Apple-converted-space">      </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|-----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>4.018 us |<span class="Apple-converted-space">  </span>1.2750 us | 0.0720 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.500 us |<span class="Apple-converted-space">  </span>0.2568 us | 0.0145 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>4.180 us |<span class="Apple-converted-space">  </span>0.6578 us | 0.0372 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>4.136 us |<span class="Apple-converted-space">  </span>0.6864 us | 0.0388 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 14.721 us |<span class="Apple-converted-space">  </span>3.6871 us | 0.2083 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 17.819 us |<span class="Apple-converted-space">  </span>4.7120 us | 0.2662 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 18.440 us | 12.3032 us | 0.6952 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>さらにloopとかを加えられるようにした。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>うーんベースクラス用意するとベンチがてきめんに落ちるのなんで。interfaceにしてみるか。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean | <span class="Apple-converted-space">      </span>Error | <span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|------------:|-----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>4.263 us | <span class="Apple-converted-space">  </span>1.6034 us |<span class="Apple-converted-space">  </span>0.0906 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.572 us | <span class="Apple-converted-space">  </span>1.3900 us |<span class="Apple-converted-space">  </span>0.0785 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>4.242 us | <span class="Apple-converted-space">  </span>1.0398 us |<span class="Apple-converted-space">  </span>0.0588 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>4.183 us | <span class="Apple-converted-space">  </span>0.6072 us |<span class="Apple-converted-space">  </span>0.0343 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 15.413 us | <span class="Apple-converted-space">  </span>3.4801 us |<span class="Apple-converted-space">  </span>0.1966 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 18.348 us |<span class="Apple-converted-space">  </span>11.8447 us |<span class="Apple-converted-space">  </span>0.6692 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 18.033 us | <span class="Apple-converted-space">  </span>0.7730 us |<span class="Apple-converted-space">  </span>0.0437 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>4.753 us | <span class="Apple-converted-space">  </span>0.7805 us |<span class="Apple-converted-space">  </span>0.0441 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>4.670 us | <span class="Apple-converted-space">  </span>0.8726 us |<span class="Apple-converted-space">  </span>0.0493 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>4.529 us | <span class="Apple-converted-space">  </span>0.5373 us |<span class="Apple-converted-space">  </span>0.0304 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 25.391 us | <span class="Apple-converted-space">  </span>5.5216 us |<span class="Apple-converted-space">  </span>0.3120 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 24.981 us | <span class="Apple-converted-space">  </span>5.8046 us |<span class="Apple-converted-space">  </span>0.3280 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 23.549 us | <span class="Apple-converted-space">  </span>7.6720 us |<span class="Apple-converted-space">  </span>0.4335 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_2sock_loop_2 | 33.197 us |<span class="Apple-converted-space">  </span>11.0151 us |<span class="Apple-converted-space">  </span>0.6224 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_10sock_loop_2 | 55.504 us | 398.8342 us | 22.5349 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_30sock_loop_2 | 43.701 us | 391.8285 us | 22.1390 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>さらに落ちた。</span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>まあ、メンテナンス性考えたらこんな感じかな～と思いつつ、遅い。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean | <span class="Apple-converted-space">    </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>5.246 us |<span class="Apple-converted-space">  </span>9.635 us | 0.5444 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.737 us |<span class="Apple-converted-space">  </span>1.059 us | 0.0598 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>4.994 us |<span class="Apple-converted-space">  </span>5.007 us | 0.2829 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>5.447 us |<span class="Apple-converted-space">  </span>6.660 us | 0.3763 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 16.707 us |<span class="Apple-converted-space">  </span>5.224 us | 0.2952 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 18.547 us |<span class="Apple-converted-space">  </span>9.683 us | 0.5471 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 18.483 us |<span class="Apple-converted-space">  </span>7.964 us | 0.4500 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>5.722 us |<span class="Apple-converted-space">  </span>6.309 us | 0.3565 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>4.856 us |<span class="Apple-converted-space">  </span>4.104 us | 0.2319 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>5.816 us |<span class="Apple-converted-space">  </span>3.047 us | 0.1721 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 29.869 us | 42.256 us | 2.3876 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 25.101 us |<span class="Apple-converted-space">  </span>3.782 us | 0.2137 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 24.649 us |<span class="Apple-converted-space">  </span>3.549 us | 0.2005 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>戻した。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean |<span class="Apple-converted-space">      </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|-----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>4.065 us |<span class="Apple-converted-space">  </span>1.7354 us | 0.0981 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.537 us |<span class="Apple-converted-space">  </span>0.9427 us | 0.0533 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>5.889 us |<span class="Apple-converted-space">  </span>8.2307 us | 0.4651 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>5.515 us |<span class="Apple-converted-space">  </span>2.4331 us | 0.1375 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 17.907 us | 28.7123 us | 1.6223 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 22.929 us | 53.0855 us | 2.9994 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 21.841 us |<span class="Apple-converted-space">  </span>3.7723 us | 0.2131 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>4.795 us |<span class="Apple-converted-space">  </span>0.9523 us | 0.0538 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>4.656 us |<span class="Apple-converted-space">  </span>0.5813 us | 0.0328 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>4.735 us |<span class="Apple-converted-space">  </span>0.5510 us | 0.0311 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 22.294 us |<span class="Apple-converted-space">  </span>6.0993 us | 0.3446 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 23.485 us | 22.0893 us | 1.2481 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 21.890 us |<span class="Apple-converted-space">  </span>7.6632 us | 0.4330 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_2sock_loop_2 | 29.881 us |<span class="Apple-converted-space">  </span>1.8279 us | 0.1033 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_10sock_loop_2 | 31.114 us | 15.8645 us | 0.8964 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_30sock_loop_2 | 33.355 us | 21.4925 us | 1.2144 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>で、最終、Pressure検知機構を付け加えたバージョン。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean |<span class="Apple-converted-space">      </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|-----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>4.040 us |<span class="Apple-converted-space">  </span>0.7995 us | 0.0452 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.549 us |<span class="Apple-converted-space">  </span>0.2411 us | 0.0136 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>4.290 us |<span class="Apple-converted-space">  </span>0.9721 us | 0.0549 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>4.220 us |<span class="Apple-converted-space">  </span>1.3237 us | 0.0748 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 16.081 us | 16.7491 us | 0.9464 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 20.856 us | 18.8980 us | 1.0678 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 18.623 us |<span class="Apple-converted-space">  </span>6.1906 us | 0.3498 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>5.197 us | 11.6224 us | 0.6567 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>5.598 us |<span class="Apple-converted-space">  </span>3.1213 us | 0.1764 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>5.065 us |<span class="Apple-converted-space">  </span>0.7191 us | 0.0406 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 22.567 us | 12.7912 us | 0.7227 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 25.333 us |<span class="Apple-converted-space">  </span>6.0615 us | 0.3425 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 23.269 us | 11.4749 us | 0.6484 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_2sock_loop_2 | 32.199 us | 16.3175 us | 0.9220 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_10sock_loop_2 | 35.051 us |<span class="Apple-converted-space">  </span>4.2557 us | 0.2405 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_30sock_loop_2 | 34.979 us |<span class="Apple-converted-space">  </span>2.1891 us | 0.1237 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><b>3.5用API</b></span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>訳あってcore2ではなく3.5でコンパイル通って欲しいバージョンで再度ロジックのみベンチ。3.5ブランチとして吐き出そう。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean | <span class="Apple-converted-space">      </span>Error | <span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|------------:|-----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>9.446 us |<span class="Apple-converted-space">  </span>42.6027 us |<span class="Apple-converted-space">  </span>2.4071 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.847 us | <span class="Apple-converted-space">  </span>0.3184 us |<span class="Apple-converted-space">  </span>0.0180 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>5.389 us | <span class="Apple-converted-space">  </span>3.2670 us |<span class="Apple-converted-space">  </span>0.1846 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>5.558 us | <span class="Apple-converted-space">  </span>1.9537 us |<span class="Apple-converted-space">  </span>0.1104 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 18.929 us |<span class="Apple-converted-space">  </span>27.2548 us |<span class="Apple-converted-space">  </span>1.5399 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 22.569 us | <span class="Apple-converted-space">  </span>5.9343 us |<span class="Apple-converted-space">  </span>0.3353 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 19.399 us | <span class="Apple-converted-space">  </span>3.3334 us |<span class="Apple-converted-space">  </span>0.1883 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>5.485 us | <span class="Apple-converted-space">  </span>0.6061 us |<span class="Apple-converted-space">  </span>0.0342 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>5.077 us | <span class="Apple-converted-space">  </span>1.6905 us |<span class="Apple-converted-space">  </span>0.0955 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>6.545 us | <span class="Apple-converted-space">  </span>5.5997 us |<span class="Apple-converted-space">  </span>0.3164 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 31.838 us |<span class="Apple-converted-space">  </span>28.0285 us |<span class="Apple-converted-space">  </span>1.5837 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 28.984 us | <span class="Apple-converted-space">  </span>7.3191 us |<span class="Apple-converted-space">  </span>0.4135 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 26.362 us | <span class="Apple-converted-space">  </span>4.1309 us |<span class="Apple-converted-space">  </span>0.2334 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_2sock_loop_2 | 49.594 us | 440.7760 us | 24.9047 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_10sock_loop_2 | 43.963 us |<span class="Apple-converted-space">  </span>62.6907 us |<span class="Apple-converted-space">  </span>3.5421 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_30sock_loop_2 | 66.129 us |<span class="Apple-converted-space">  </span>55.2169 us |<span class="Apple-converted-space">  </span>3.1199 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>やはり目立って遅い。差はconcurrentQueueの有無なので、こう、やっぱlockより速いんだなあ。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><b>若干のAPIパラメータを調整、デバッグ用ログの追加(オン状態)</b></span></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>dotnet core 2.0用のラスト。</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                          </span>Method |<span class="Apple-converted-space">      </span>Mean |<span class="Apple-converted-space">      </span>Error |<span class="Apple-converted-space">    </span>StdDev |</span></p>
<p class="p4"><span class="s2">-------------------------------- |----------:|-----------:|----------:|</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">         </span>Take_10byte_2sock_async |<span class="Apple-converted-space">  </span>4.656 us |<span class="Apple-converted-space">  </span>6.2569 us | 0.3535 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">          </span>Take_10byte_2sock_sync |<span class="Apple-converted-space">  </span>1.730 us |<span class="Apple-converted-space">  </span>0.9745 us | 0.0551 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_10sock_async |<span class="Apple-converted-space">  </span>4.337 us |<span class="Apple-converted-space">  </span>0.4410 us | 0.0249 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_30sock_async |<span class="Apple-converted-space">  </span>4.262 us |<span class="Apple-converted-space">  </span>0.7247 us | 0.0409 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_sync_10item | 17.134 us |<span class="Apple-converted-space">  </span>8.7683 us | 0.4954 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_10sock_async_10item | 21.383 us | 16.5207 us | 0.9335 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space"> </span>Take_10byte_30sock_async_10item | 22.547 us |<span class="Apple-converted-space">  </span>3.6320 us | 0.2052 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">      </span>Take_10byte_2sock_pipeline |<span class="Apple-converted-space">  </span>6.301 us |<span class="Apple-converted-space">  </span>1.8376 us | 0.1038 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_10sock_pipeline |<span class="Apple-converted-space">  </span>5.949 us |<span class="Apple-converted-space">  </span>2.8413 us | 0.1605 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">     </span>Take_10byte_30sock_pipeline |<span class="Apple-converted-space">  </span>6.673 us |<span class="Apple-converted-space">  </span>4.2911 us | 0.2425 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">   </span>Take_10byte_2sock_pipeline_10 | 29.744 us | 20.4818 us | 1.1573 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_10sock_pipeline_10 | 25.569 us | 10.5866 us | 0.5982 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">  </span>Take_10byte_30sock_pipeline_10 | 23.797 us |<span class="Apple-converted-space">  </span>3.4032 us | 0.1923 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>Take_10byte_2sock_loop_2 | 35.643 us | 21.8902 us | 1.2368 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_10sock_loop_2 | 35.144 us | 16.8500 us | 0.9521 us |</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">       </span>Take_10byte_30sock_loop_2 | 35.683 us | 12.4644 us | 0.7043 us |</span></p>
<p class="p7"><span class="s2"></span><br></p>
<p class="p8"><span class="s2"><span class="Apple-tab-span">	</span>3.5版と比べてだいたい倍くらい高速。</span></p>
<p class="p7"><span class="s2"></span><br></p>
</body>
</html>
