<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1138.47">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Kaku Gothic ProN'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Kaku Gothic ProN'}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; color: #2c00ee}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Courier; color: #028080}
    span.s1 {font: 22.0px Helvetica}
    span.s2 {font: 12.0px 'Hiragino Kaku Gothic ProN'}
    span.s3 {font: 12.0px Helvetica}
    span.s4 {font: 12.0px Times; text-decoration: underline ; color: #2c00ee}
    span.s5 {font: 12.0px 'Hiragino Mincho ProN'}
    span.s6 {font: 12.0px Times}
    span.s7 {text-decoration: underline}
    span.s8 {font: 12.0px 'Hiragino Kaku Gothic ProN'; color: #000000}
    span.s9 {color: #000000}
    span.s10 {color: #009999}
    span.Apple-tab-span {white-space:pre}
    td.td1 {width: 52.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td2 {width: 360.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td3 {width: 254.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
    td.td4 {width: 300.0px; margin: 0.5px 0.5px 0.5px 0.5px; padding: 1.0px 1.0px 1.0px 1.0px}
  </style>
<script type="text/javascript" src="http://platform.twitter.com/anywhere.js?id=bKHhDxNgJLJUmFmej4sEw&v=1"></script>
</head>
<body>
<p class="p1"><span class="s1"><b>Java</b></span><b>でローカルの変数名を取得する</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>概要</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>Javaのプログラム中、</p>
<pre class="code">String a = <span class="s2">なにやら</span>;</pre>
<pre class="code">log(a.name()+"="+a);</pre>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>と書いて、</p>
<p class="p3"><span class="Apple-tab-span">	</span>関数logから出力されるのが、</p>
<p class="p2"><br></p>
<pre class="code"><span class="s3">a:</span>なにやら</pre>
<p class="p3"><span class="Apple-tab-span">	</span>とかなると、後から追うときちょっと楽かなと思った。</p>
<p class="p3"><span class="Apple-tab-span">	</span>具体的には、記述として</p>
<p class="p2"><br></p>
<pre class="code">String val1 = "val1Value";</pre>
<pre class="code">String val2 = "val2Value";</pre>
<pre class="code">System.out.println("val1="+ val1+"val2"+ val2);</pre>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ってのが</p>
<pre class="code">String val1 = "val1Value";</pre>
<pre class="code">String val2 = "val2Value";</pre>
<pre class="code">System.out.println(val1.name()+"="+ val1+val2.name()+"="+ val2);</pre>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>になる。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>特に<b>リファクタリングが楽そう</b>。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>もちろんStringクラスにフィールド名吐くnameメソッドなど無い。</p>
<p class="p3"><span class="Apple-tab-span">	</span>(C#だとnameプロパティ有るけどねwww　って教えてくれたobhrありがとう。ムカつく。)</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>方法's</b></p>
<p class="p3"><b>コンパイラにオプション渡してそれっぽい情報がclassに乗るようにする＋リフレクション</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>@tan_go238さん、@backpaper0 さん、@kimukou2628さん、@kurobaraさん、より</p>
<p class="p3"><span class="s3"><img src="%E4%B8%8D%E6%98%8E.png" alt="不明.png"></span><b>backpaper0 </b>@tan_go238 @toru_inoue -gか-g:varsつけてjavacしないとローカル変数名や引数名って消えちゃう気が。フィールド名は普通に取れるけど。<a href="https://twitter.com/backpaper0/status/214274130906845184"><span class="s4">12/06/17 17:31</span></a></p>
<table cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td colspan="2" valign="middle" class="td1">
        <p class="p5"><br></p>
        <p class="p5"><br></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p3"><b>Javassistを使う</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>@masanobuimai さんより</p>
<table cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p4"><img src="1__%23$!@%25!%23__%E4%B8%8D%E6%98%8E.png" alt="1__#$!@%!#__不明.png"></p>
      </td>
      <td valign="middle" class="td2">
        <p class="p6"><b>masanobuimai</b></p>
        <p class="p6">@toru_inoue javassist<span class="s5">使うとできるみたいですよ。<a href="http://t.co/lt4GcxGx"><span class="s6">http://t.co/lt4GcxGx</span></a></span></p>
        <p class="p7"><span class="s7"><a href="https://twitter.com/masanobuimai/status/214278362900873216">12/06/17 17:48</a></span></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>Paranamerを使う</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>@esmasui さんより。</p>
<table cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p4"><img src="1__%23$!@%25!%23__1__%23$!@%25!%23__%E4%B8%8D%E6%98%8E.png" alt="1__#$!@%!#__1__#$!@%!#__不明.png"></p>
      </td>
      <td valign="middle" class="td3">
        <p class="p6"><b>esmasui</b></p>
        <p class="p6">@toru_inoue<span class="Apple-converted-space">  </span>paranamer<span class="s5">使うといいと思いますの</span></p>
        <p class="p7"><span class="s7"><a href="https://twitter.com/esmasui/status/214284783226851330">12/06/17 18:14</a></span></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>これか。</p>
<p class="p3"><span class="Apple-tab-span">	</span><a href="http://paranamer.codehaus.org/">http://paranamer.codehaus.org/</a></p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>使用例は</p>
<p class="p3"><b><span class="Apple-tab-span">	</span></b><a href="http://d.hatena.ne.jp/Kazzz/20100222/p1">http://d.hatena.ne.jp/Kazzz/20100222/p1</a></p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>感想：Twitterすごい。</b></p>
<p class="p2"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p3"><span class="Apple-tab-span">	</span>今回は用途が[できなくてはいけない]というレベルではないため、さすがにJavasstとかは</p>
<p class="p3"><span class="Apple-tab-span">	</span>つかえないが、、</p>
<p class="p3"><span class="Apple-tab-span">	</span>勉強になった。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p3"><span class="Apple-tab-span">	</span>で、</p>
<p class="p2"><b></b><br></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b>ここからうらがみさん無双</b></p>
<table cellspacing="0" cellpadding="0">
  <tbody>
    <tr>
      <td valign="middle" class="td1">
        <p class="p4"><img src="2__%23$!@%25!%23__%E4%B8%8D%E6%98%8E.png" alt="2__#$!@%!#__不明.png"></p>
      </td>
      <td valign="middle" class="td4">
        <p class="p6"><b>backpaper0</b></p>
        <p class="p6">@tan_go238 @toru_inoue <span class="s5">やっとできた</span><a href="https://t.co/VOT8i5og">https://t.co/VOT8i5og</a></p>
        <p class="p7"><span class="s7"><a href="https://twitter.com/backpaper0/status/214287918108393473">12/06/17 18:26</a></span></p>
      </td>
    </tr>
  </tbody>
</table>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span></b>ふえー。できるもんなんだ、、　うらがみさんすげー、、！</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>手元で確認した範囲だと、</p>
<p class="p2"><br></p>
<p class="p8"><span class="s8"><span class="Apple-tab-span">	</span></span><span class="s9">attr<b>.</b></span>getConstPool<span class="s9"><b>().</b></span>getUtf8Info<span class="s9"><b>(</b>attr<b>.</b></span>nameIndex<span class="s9"><b>(</b></span><span class="s10">1</span><span class="s9"><b>));</b></span></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>はnameIndex(0)でthis,　1でaを返してくる。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>言語仕様的に、採番は定義順っぽいんだけど(自分が、それ以外の方法でJVMが値マッピングの方法をとっている、という部分を見つけられなかったため確証は無い)</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>どうしても心配なら、順は保証されてないことにして、値の集合として扱えばいいと思う。</p>
<p class="p3"><span class="Apple-tab-span">	</span>そういうふうにClassから切れば、つかえる。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>1宣言のために1クラスだととっても効率悪いけど、1集合とかなら行けそう。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>突然の話題に返答ありがとう！</p>
<p class="p3"><b><span class="Apple-tab-span">	</span>重ねてお礼申し上げます。</b></p>
<p class="p2"><b></b><br></p>
<p class="p3"><b><span class="Apple-tab-span">	</span>神様、見てたらうらがみさんに日曜日をもう一日。</b></p>
<script type="text/javascript">
  twttr.anywhere(function (T) {
    T.hovercards();
  });
</script>
</body>
</html>
