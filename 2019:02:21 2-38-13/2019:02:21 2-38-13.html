<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head><link rel="stylesheet" type="text/less" href="../stylesheets/less/default.less"/><script type="text/javascript" src="../javascripts/less-1.3.0.min.js"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="1671.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 22.0px 'Hiragino Sans'}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'; min-height: 18.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Hiragino Sans'}
    span.s1 {font: 22.0px Helvetica}
    span.Apple-tab-span {white-space:pre}
  </style>
</head>
<body>
<p class="p1"><span class="s1"><b>Unity</b></span><b>でインカメラを使ってストリーミング動画をアレする</b></p>
<p class="p2"><br></p>
<p class="p3"><b>概要</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>お前はなぜそれをUnityで シリーズ。</p>
<p class="p3"><span class="Apple-tab-span">	</span>やる。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><b>WebCamTexture</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>これ使えばいけそう。</p>
<p class="p3"><span class="Apple-tab-span">	</span>https://docs.unity3d.com/ScriptReference/WebCamTexture-devices.html</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ドキュメントに書いといてほしいんだけど、</p>
<p class="p3"><span class="Apple-tab-span">	</span>Nativeのカメラから取得できるテクスチャ、無茶苦茶制約が強い。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>具体的には、</p>
<p class="p3"><span class="Apple-tab-span">	</span>・サイズ指定が効くわけではない、一番近いサイズが来る(なんでだよ)</p>
<p class="p3"><span class="Apple-tab-span">	</span>・取得後にサイズ調整すると中身が消える(なんでだよ)</p>
<p class="p3"><span class="Apple-tab-span">	</span>・Spriteにしてから取得しても中身が消える(いやだからなんでだよ)</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>なので、WebCamTexから取得 -&gt; byte化 -&gt; byteからテクスチャ生成 -&gt; 変形 -&gt; byte化 とかが使えるのでは。</p>
<p class="p3"><span class="Apple-tab-span">	</span>-&gt; いけた。</p>
<p class="p2"><span class="Apple-tab-span">	</span></p>
<p class="p2"><br></p>
<p class="p3"><b>まとめ</b></p>
<p class="p3"><span class="Apple-tab-span">	</span>WebCamTextureを使う場合、次のような手順を踏むといい感じにリサイズできる。</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>1.GetPixelsで通常のテクスチャに移動</p>
<p class="p3"><span class="Apple-tab-span">	</span>2.このテクスチャをjpg byte[]に変換</p>
<p class="p3"><span class="Apple-tab-span">	</span>3.jpeg byte[] からテクスチャを生成</p>
<p class="p3"><span class="Apple-tab-span">	</span>4.3にリサイズ処理を施す</p>
<p class="p3"><span class="Apple-tab-span">	</span>5.4をjpg byte[]に変換</p>
<p class="p2"><br></p>
<p class="p3"><span class="Apple-tab-span">	</span>ほんとなんでだよ。</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p3">まあ、ネイティブのUIImageとかが保持してるリソースのGetPixelsが、ポインタを移動してるだけなのでは？という気がしている。</p>
</body>
</html>
